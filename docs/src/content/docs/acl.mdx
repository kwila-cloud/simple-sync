---
title: Access Control List (ACL)
description: Specification for the Access Control List system in Simple SYnc
---
import { Aside } from '@astrojs/starlight/components';

The Access Control List (ACL) defines the relationships between users, items, and actions. It determines which users are allowed to perform which actions on which items.

## Default Behavior

*   All users can view all events. This means that Simple SYnc is **only** appropriate for situations where **all** users of the system can be trusted to view **all** data in the system.
*   By default, a user cannot perform any action on any item unless explicitly allowed by an ACL rule (deny all by default).
     * Note: there is a difference between viewing items and performing actions on items. All users can view all items because they can read all the events. However, they can not submit new events that perform actions on items without ACL rules to allow it.
*   The ".root" user has implicit access to all items and actions, bypassing ACL checks.

## ACL Structure

ACL rules are managed through events on a special ".acl" item. Each ACL event has an action of either "allow" or "deny" and a payload containing the rule details:

```json
{
  "user": "string",
  "item": "string",
  "action": "string"
}
```

<Aside type="caution">
Rules with empty user, item, or action fields are not allowed.
</Aside>

*   `user`: Specifies the user or users to which the rule applies. Can be a specific user UUID or a wildcard (`*`) to match all users.
*   `item`: Specifies the item or items to which the rule applies. Can be a specific item UUID, a wildcard (`*`) to match all items, or a prefix-based wildcard (e.g., `task-*`) to match all items with a UUID that starts with the specified prefix.
*   `action`: Specifies the action to which the rule applies. Can be a specific action name (e.g., "create", "update", "delete") or a wildcard (`*`) to match all actions.

ACL events are submitted via POST /api/v1/events and are validated against the current ACL before being added to the authoritative event history. Invalid ACL events are ignored.

## Wildcard Support

The `user` and `action` fields support the wildcard (`*`) to match multiple users or actions. The `item` field supports the wildcard (`*`) to match all items, and also supports prefix-based wildcards (e.g., `task-*`) to match all items with a UUID that starts with the specified prefix.

## Rule Evaluation

ACL rules are evaluated based on specificity. For a given user, item, and action, the rule with the highest specificity score determines whether the action is allowed or denied. Specificity is calculated as the total character count of the user, item, and action portions of a matching rule (excluding the wildcard).

### Specificity Examples

For a request by user "user123" to perform "edit" on item "task-456":

- Rule: user="*", item="*", action="*" → score: 0 + 0 + 0 = 0
- Rule: user="user123", item="*", action="*" → score: 7 + 0 + 0 = 7 (exact user match)
- Rule: user="*", item="task-*", action="*" → score: 0 + 6.5 + 0 = 6.5 (prefix item match: "task-" = 5 + 0.5 = 5.5, "-" = 1, total 6.5)
- Rule: user="*", item="*", action="edit" → score: 0 + 0 + 4 = 4 (exact action match)

The rule with user="user123" wins with score 7.

For item "task-456" and action "edit", if no exact user match:

- Rule: user="*", item="task-*", action="edit" → score: 0 + 6.5 + 4 = 10.5
- Rule: user="*", item="*", action="edit" → score: 0 + 0 + 4 = 4

The prefix rule wins with 10.5.
### Tie Breakers

If multiple rules have the same score, the most recently added rule (highest timestamp) takes precedence. If no rule matches, the default behavior (deny all actions) applies.

## Examples

To allow all users to mark "task.123" as complete:

```json
{
  "uuid": "acl-event-1",
  "timestamp": 1678886400,
  "userUuid": "admin.user1",
  "itemUuid": ".acl",
  "action": "allow",
  "payload": {
    "user": "*",
    "item": "task.123",
    "action": "markComplete"
  }
}
```

To allow user "user456" to edit any item:

```json
{
  "uuid": "acl-event-2",
  "timestamp": 1678886401,
  "userUuid": "admin.user1",
  "itemUuid": ".acl",
  "action": "allow",
  "payload": {
    "user": "user456",
    "item": "*",
    "action": "edit"
  }
}
```

To allow all admin users to delete any task:

```json
{
  "uuid": "acl-event-3",
  "timestamp": 1678886402,
  "userUuid": "admin.user1",
  "itemUuid": ".acl",
  "action": "allow",
  "payload": {
    "user": "admin.*",
    "item": "task.*",
    "action": "delete"
  }
}
```

## ACL Management

ACL rules are managed by submitting events to the POST /api/v1/events endpoint with `itemUuid` set to ".acl" and `action` set to "allow" or "deny". The payload must contain `user`, `item`, and `action` fields defining the rule. ACL events are validated against the current ACL before being added to the authoritative history; invalid ACL events are ignored.

The current ACL state can be inferred from the authoritative event history by filtering for ".acl" events. See the [v1 API Specification](/simple-sync/api/v1) for details on event submission.

**Note:** ACL events require appropriate permissions based on existing rules. The ".root" user has implicit access to submit any ACL events.
